CID : 가맹점코드, 제휴를 통해 발급 결제 유형과 단위정의  10자리
TID : 결제 한 건에 대한 고유번호, 결제준비  API가 성공적으로 호출되면 발급 20자리
SID : 정기결제에 사용되는 고유번호, 정기결제1회차 프로세스가 완료되면 발급, 20자리 2회차 정기
결제부터는 SID를 이용해 결제 요청
AID : 결제, 취소, 정기 결제API 호출에 대한 고유번호, 각 API 호출 성공시 발급 20자리


결제필수  값:
partner_order_id : 결제건에 대한 가맹점의 주문번호
parter_user_id   : 가맹점에서 사용자를 구분할 수 있는  id
pg_token  : 결제 승인 요청을 인증하는 토큰 



결제프로세스 
1. 결제준비 : 가맹점코드 CID  , 가맹점이 부여한 주문번호 parter_order_id , 상품총액 total_amount등 상세
정보를 카카오페이 서버에 전달하고 결제과정을 시작하는 단계

2.정보확인및 사용자인증  : 사용자 정보 입력 및 카카오페이 결제 수단 선택과 인증이 이뤄지는 단계
3.인증완료:  사용자의 인증이 완료되고  승인에 필요한 인증값을 응답주는 단계
4.결제승인 : 결제 필수 값으로 카카오페이 서버에 승인요청하여 최종적으로 결제완료처리를 하는 단계

pc web
1. 결제준비  (결제준비API)  2. 사용자정보입력 ( 카카오톡메시지 발송) , 3.카카오톡/페이이동 ( 결제수단선택) 
4. 결제승인요청( 결제승인API) 5. 결제완료



1.결제준비 
 서버에게 결제준비 API를 호출합니다
 응답이 오면 요청한 결제와 TID를 매핑 Mapping하여 저장하고 
 추후결제 승인API호출 및 대사작업에 사용합니다
 보안을 위해  TID가 사용자에게 노출되지 않도록 주의합니다. 응답본문으로 받은 
 next_redirect_pc_url값으로 결제 대기화면을 팝업 혹은 레이어 방식으로 띄웁니다

2. 사용자 정보 입력
  사용자는 전화번호 및 생년월일을 입력합니다. 올바른 정보가 입력되면 카카오톡으로 결제 요청 메시지가 전송되고
 사용자정보 입력 화면은 결제 대기화면으로 변경됩니다
 사용자는 결제요청 메시지를 통해 결제화면으로 이동해 결제수단을 선택합니다

3.결제대기화면은 결제요청결과에 따라 각각 다른   URL로 리다이렉트(rediret)됩니다 
 사용자가 결제를  취소한 경우 , 보안을 위해  주문상세조회 API를 호출하고 결제과정을 중단해야 합니다
조회시 상태값이 사용자가 결제를 중단한 상태임을 나타내는 QUIT_PAYMENT 인 것을 확인하고 결제중단처리를 해야 합니다


요청결과별 리다이렉트  URL

요청성공 :  approval_url로 리다이렉트 
요청취소 : cancel_url로 리다이렉트 
요청 유효시간 (15분) : fail_url로 리다이렉트 


주의 !!! 
apprval_url, cancel_url, fail_url 은 카카오페이 API 요청 응답을 받아 처리할 주소입니다
이 값들의 도메인은 앱정보에 등록된 웹플랫폼 도메인과 일치해야 합니다

4. 결제 승인 
  결제 대기 단계에서 결제요청에 성공했다면 결제 승인 API를 호출합니다 
  이때 결제 승인 요청을 인증하는   pg_token을 전달해야 합니다
  pg_token은 사용자가 결제 수단을 선택하고 결제버튼을 눌러   approval_url로 리다이렉트될 때 
리다렉트 요청의  approval_url에 포함된   query string 으로 전달 받습니다













